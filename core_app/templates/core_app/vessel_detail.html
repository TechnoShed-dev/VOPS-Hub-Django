{# VOPS-Hub/core_app/templates/core_app/vessel_detail.html #}
{% extends 'core_app/base.html' %}

{% block title %}{{ vessel.vessel_name }} Details - VOPS-Hub{% endblock title %}

{% block content %}
<div class="row">
    <div class="col-md-8 offset-md-2">
        <div class="card mb-4 shadow-sm">
            <div class="card-header bg-primary text-white">
                <h2 class="card-title mb-0">{{ vessel.vessel_name }}</h2>
            </div>
            <div class="card-body">
                <p class="card-text"><strong>Capacity:</strong> {{ vessel.capacity|default:"N/A" }}</p>
                <p class="card-text"><strong>Number of Decks:</strong> {{ vessel.number_of_decks|default:"N/A" }}</p>
                <p class="card-text"><strong>General Notes:</strong> {{ vessel.general_notes|default:"None" }}</p>
                <p class="card-text"><strong>Additional Hazards:</strong> {{ vessel.additional_hazards|default:"None" }}</p>
                <p class="card-text"><strong>Deck Layout Link:</strong>
                    {% if vessel.deck_layout_link %}
                        <a href="{{ vessel.deck_layout_link }}" target="_blank">View Deck Layout</a>
                    {% else %}
                        N/A
                    {% endif %}
                </p>
                <p class="card-text"><strong>Risk Assessment Document Link:</strong>
                    {% if vessel.risk_assessment_document_link %}
                        <a href="{{ vessel.risk_assessment_document_link }}" target="_blank">View RA Document</a>
                    {% else %}
                        N/A
                    {% endif %}
                </p>
                <p class="card-text"><strong>Vessel Info Link:</strong>
                    {% if vessel.vessel_info_link %}
                        <a href="{{ vessel.vessel_info_link }}" target="_blank">View Vessel Info</a>
                    {% else %}
                        N/A
                    {% endif %}
                </p>
            </div>
            <div class="card-footer text-muted">
                <a href="{% url 'core_app:vessel_list' %}" class="btn btn-secondary btn-sm">Back to Vessel List</a> {# UPDATED URL #}
            </div>
        </div>

        <h3 class="mt-4 mb-3">Deck Heights</h3>
        {% if deck_heights %}
            <ul class="list-group mb-4">
                {% for deck in deck_heights %}
                    <li class="list-group-item">
                        <strong>Deck Name:</strong> {{ deck.deck_name|default:"N/A" }} (ID: {{ deck.deck_id|default:"N/A" }})<br>
                        <strong>Average Deck Height:</strong> {{ deck.average_deck_height_m|default:"N/A" }} m
                        <small class="text-muted d-block">Type: {{ deck.deck_type|default:"N/A" }}</small>
                        <small class="text-muted d-block">Notes: {{ deck.notes|default:"None" }}</small>
                    </li>
                {% endfor %}
            </ul>
        {% else %}
            <p>No deck heights recorded for this vessel.</p>
        {% endif %}

        <h3 class="mt-4 mb-3">Comments</h3>
        {% if comments %}
            <div class="list-group">
                {% for comment in comments %}
                    <div class="list-group-item list-group-item-light mb-2">
                        <h5 class="mb-1">{{ comment.comment_title }}</h5>
                        <p class="mb-1">{{ comment.comment_details }}</p>
                        <small class="text-muted">By {{ comment.comment_by|default:"Anonymous" }} on {{ comment.date_of_comment|date:"d M Y H:i" }}</small>
                    </div>
                {% endfor %}
            </div>
        {% else %}
            <p>No comments for this vessel.</p>
        {% endif %}
    </div>
</div>
{% endblock content %}